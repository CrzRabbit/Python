'''
给你一个整数方阵 arr ，定义「非零偏移下降路径」为：从 arr 数组中的每一行选择一个数字，且按顺序选出来的数字中，相邻数字不在原数组的同一列。

请你返回非零偏移下降路径数字和的最小值。


示例 1：

输入：arr = [[1,2,3],[4,5,6],[7,8,9]]
输出：13
解释：
所有非零偏移下降路径包括：
[1,5,9], [1,5,7], [1,6,7], [1,6,8],
[2,4,8], [2,4,9], [2,6,7], [2,6,8],
[3,4,8], [3,4,9], [3,5,7], [3,5,9]
下降路径中数字和最小的是 [1,5,7] ，所以答案是 13 。

提示：

1 <= arr.length == arr[i].length <= 200
-99 <= arr[i][j] <= 99
'''
import heapq
from typing import List

from leetcode.tools.time import printTime


class Solution:
    '''
    DP
    '''
    @printTime()
    def minFallingPathSum(self, arr: List[List[int]]) -> int:
        len1 = len(arr)
        len2 = len(arr[0])
        dp = [[0 for _ in range(len2)] for _ in range(len1)]
        temp1 = []
        for j in range(len2):
            dp[0][j] = arr[0][j]
            heapq.heappush(temp1, [dp[0][j], j])
        for i in range(1, len1):
            temp2 = []
            t1 = heapq.heappop(temp1)
            t2 = heapq.heappop(temp1)
            for j in range(len2):
                dp[i][j] = arr[i][j] + (t1[0] if j != t1[1] else t2[0])
                heapq.heappush(temp2, [dp[i][j], j])
                temp2 = temp2[:3]
            temp1 = temp2
        return min(dp[-1])

arr = [[-78,-48,91,26,-70,8,65,67,79,-79,64,-2,80,-76,-95,-40,39,-68,58,-34,62,-91,87,19,65,33,-11,99,2,67,22,66,46,-25,-42,29,-60,-68,-14,66,-13,91,-84,-84,31,-97,91,61,-89,37],[75,-81,40,65,-95,-15,-34,76,-6,19,71,-31,74,70,-25,-35,-64,-38,-62,86,-93,89,-67,92,-96,68,49,59,-90,35,42,-23,31,18,-1,-15,18,-51,-7,51,80,64,99,-67,14,10,-6,36,82,-45],[25,-10,-90,-98,-16,-88,11,74,-24,-79,10,-20,-38,-9,-39,98,-51,70,85,8,-95,-77,-77,-46,74,-57,51,-62,-71,84,73,-70,-29,-13,49,71,22,-76,-51,6,83,-24,61,-9,65,68,28,7,68,-35],[-82,24,64,-62,-58,77,-30,27,-45,-60,-59,4,-54,81,54,-62,41,-17,-63,-28,89,44,-99,66,67,22,25,-19,-86,-33,89,99,-76,-99,90,35,-4,85,-93,10,98,65,59,-45,40,-41,-40,-2,-82,-21],[77,-6,26,66,37,-6,61,48,96,3,66,44,85,86,3,-9,55,38,39,97,-42,31,65,95,88,87,-12,99,-10,-23,-85,-94,23,-98,-41,80,-61,-90,-13,-31,-30,91,44,72,91,63,-19,74,-59,70],[18,-64,-53,-59,-66,73,85,-85,79,97,16,-1,-14,78,50,46,19,-40,6,68,-63,-89,95,94,-56,16,-11,32,-28,-10,-24,-10,-10,-13,84,-54,-3,-96,92,-43,62,99,-49,-62,-89,60,-25,38,27,69],[-49,-17,27,-43,57,-15,-40,33,28,77,-31,-68,-12,-77,-47,-71,-66,-30,47,-12,99,-68,-90,-37,16,-26,-54,98,54,-17,37,-73,74,80,-13,-28,-77,26,18,49,72,69,18,-72,-71,65,-12,-91,-47,66],[22,-61,98,19,-55,8,-98,80,79,67,-5,31,72,99,-2,95,99,-20,57,-70,85,41,-75,-60,73,53,-81,85,18,29,19,-56,54,78,16,-96,-56,-56,62,-53,-85,75,-71,-41,3,26,16,91,32,-92],[-7,82,-79,-1,-47,-39,-33,-12,5,10,96,23,98,-81,-26,38,-64,11,17,62,-38,7,-81,-7,21,-37,86,-44,-83,-14,65,-79,58,-43,-56,78,2,99,5,-36,-60,2,-50,-9,-60,-96,83,-89,24,-2],[-94,81,77,76,-67,-36,71,39,-63,81,-70,-42,49,-75,90,-39,-39,56,29,-25,-18,70,66,-51,5,-31,-57,-67,-49,90,-64,8,-93,-56,-42,58,36,-65,97,47,36,-79,-16,80,27,20,-82,82,-67,98],[-51,69,79,-71,-67,-20,-85,23,57,49,78,36,-69,-85,90,46,-8,29,-78,9,-8,1,-23,-3,-12,72,-47,-79,-5,41,-38,44,13,-54,-20,47,90,-66,-87,-47,2,-43,-39,-95,87,0,2,-12,-91,5],[58,96,-98,59,17,84,-32,39,54,-37,-43,96,97,-3,-18,-94,17,50,-83,79,-90,75,-95,-11,-10,76,-70,9,38,35,18,13,8,28,84,50,-84,97,-50,-8,-18,63,53,30,74,-21,30,23,35,-25],[7,65,56,-36,52,79,-97,22,-78,92,-56,89,64,-12,0,84,-15,35,-93,-84,-73,-49,35,61,3,57,-66,-96,-11,-17,-35,69,-77,24,-69,85,2,-24,66,84,23,80,97,-49,-34,71,-99,42,-22,-1],[-50,86,-87,-34,-3,84,-27,32,-91,49,-35,43,-84,11,95,13,-95,-9,-13,28,-39,74,61,59,26,22,-54,86,-60,33,86,13,78,-79,-31,55,-3,22,-69,20,95,97,-75,43,26,12,9,56,5,-61],[-90,5,-95,-55,-43,-71,-4,49,39,-41,-61,-24,23,60,78,-41,-72,-63,34,62,-18,-49,13,-96,28,37,-16,94,-69,74,-12,93,38,-56,-51,41,22,57,-25,-28,-36,-43,45,-58,74,-29,-67,10,10,29],[43,-57,-86,-46,-85,67,-59,-78,97,72,20,16,-8,48,-2,97,69,-93,-96,87,-60,-57,-16,27,-8,-75,0,30,-1,99,-56,61,-2,6,-38,-48,-29,-14,19,-90,63,-87,54,21,24,-90,21,46,90,-4],[0,2,-26,-76,-78,80,80,53,57,-93,-54,83,32,97,72,14,-10,-30,96,-85,-94,-13,13,-69,44,64,-20,33,9,-90,-56,-95,-8,96,-76,34,78,76,-67,-54,4,-17,50,14,-1,-50,33,-67,-25,41],[-5,89,17,50,-84,-36,13,-11,85,-23,11,95,-4,-55,85,29,-55,96,-4,84,-14,-98,4,-67,53,30,14,-80,-41,-25,12,55,58,-55,-88,60,-73,-92,4,42,74,-67,5,-83,-26,-79,60,35,12,66],[16,24,80,49,78,-67,-58,-89,-53,-59,0,-95,66,-88,-39,76,-99,16,88,-34,-5,98,46,-41,17,-8,-6,-21,-30,84,85,-94,87,-2,-24,-3,-2,36,3,65,-85,30,-1,59,-35,-45,69,-56,-36,-90],[88,-21,67,3,-86,29,54,90,95,-5,-79,30,7,-10,-87,31,-19,-58,-46,-59,-14,23,62,34,-24,-1,76,97,-21,-78,-55,-55,-69,74,39,-58,-3,23,-80,-8,-13,56,67,-6,-29,69,60,-93,40,-72],[-92,7,-21,34,-63,66,-53,-19,-41,-68,31,-33,-55,85,75,50,-81,-2,-71,76,-59,-25,-82,9,40,83,35,-18,53,-81,-76,-5,-12,-14,-58,-88,-87,27,-22,-42,-43,7,92,-76,57,-51,-82,-72,64,-82],[-49,3,-62,-62,-37,-85,-15,63,-78,99,-93,-44,60,-85,-78,-34,-32,-75,-6,-45,-56,-40,-70,5,22,10,-82,26,27,87,-63,-35,79,93,24,85,-34,-78,-37,49,-60,-7,75,-91,21,-56,37,84,28,-93],[-58,89,-64,56,-57,83,57,-67,-46,42,5,-88,81,20,27,29,60,-19,73,16,83,29,91,5,57,-3,-88,-73,7,85,78,-24,-51,30,49,-90,-72,34,5,10,-31,-97,97,32,6,88,-70,-60,-41,-52],[52,-74,-48,-59,85,-78,72,71,-33,96,20,56,16,82,-71,7,-61,2,-17,-43,-40,87,-78,-43,-51,-75,40,-49,43,-58,71,-27,58,-58,67,53,-17,-56,92,21,10,98,-74,30,-52,-95,88,-56,-96,91],[-77,-36,79,-98,7,-67,-54,1,-36,71,-99,33,28,-84,20,66,47,81,59,-59,68,-2,95,-1,92,33,-30,79,-59,-65,-95,-23,-24,-11,98,70,-88,-50,-21,-66,-10,84,-81,8,6,57,6,27,83,-63],[-71,-61,42,69,20,75,25,64,-19,1,43,-61,-75,-58,-68,-70,62,14,31,58,-49,-99,-39,-87,16,43,69,73,53,-93,-3,-71,-87,8,96,3,-44,53,19,-57,-19,43,57,-45,74,-74,26,44,40,23],[-39,-39,-79,-24,-12,-29,61,-58,76,89,61,-82,7,7,-90,60,-56,89,-16,-27,-64,-97,-31,86,63,54,6,87,-43,-46,42,-66,43,-37,92,-51,1,73,-35,92,-69,-78,-27,29,-66,-59,-21,-76,64,42],[-25,-21,-68,-50,34,76,53,18,84,22,-45,-14,80,82,-60,88,-64,-8,-22,18,10,-94,89,-2,66,-29,86,59,-28,-94,59,53,-59,-71,-12,84,81,-94,76,-74,97,-41,81,-85,-14,18,54,-28,11,-56],[-90,90,94,36,35,-13,56,47,-50,-48,1,-97,-14,93,-43,86,36,59,-6,96,49,40,44,15,-33,-80,-77,79,-91,-28,-66,-3,-83,51,-69,4,-18,51,-90,-98,86,20,35,-63,29,-19,97,98,51,-10],[99,29,41,12,41,45,58,-80,-60,-78,67,-91,-65,38,55,14,90,-8,-78,-61,-87,50,-63,-16,-86,18,77,30,35,68,-90,5,50,47,61,71,-13,98,95,-68,80,97,-41,7,-68,10,-47,-77,-12,49],[-2,-7,-57,24,-62,40,79,28,44,-1,17,-2,-49,-50,-2,-43,30,71,69,76,73,97,-26,-77,74,-89,-16,-64,-8,-62,68,-76,6,-41,-80,98,94,69,-63,84,38,-10,-50,-68,-20,-42,-2,21,13,83],[97,62,41,-79,-74,-39,15,16,63,63,-80,94,12,1,-99,82,93,-65,8,-43,20,-16,63,8,68,-37,85,-39,82,63,-11,-72,-88,-73,12,61,82,-24,-87,1,-21,-78,92,-56,90,-49,-47,61,79,-92],[23,44,17,88,18,-58,-95,11,-72,80,-57,60,8,-31,14,5,-25,80,-73,13,98,67,-67,70,45,33,-91,-63,96,-46,83,-22,79,-91,-53,-34,53,19,-10,21,-72,-7,84,-34,-44,-76,98,62,22,-9],[85,-32,69,42,-44,-50,-59,-80,11,19,-35,-4,3,-6,25,17,80,-40,-34,-88,-62,46,-77,-22,80,-18,39,77,88,-85,-76,7,-40,72,-56,68,3,18,52,-74,-61,-65,14,-90,25,-28,83,-64,-95,-13],[37,-35,-35,-39,52,29,27,71,21,-99,-40,-55,-52,-81,38,49,-38,47,-27,16,-18,-90,45,92,30,60,57,49,-50,-33,78,-17,-22,78,-94,5,-77,42,-62,-52,28,-72,-59,27,36,-66,53,-85,2,66],[-40,93,-24,12,-31,-92,76,-75,67,-68,29,33,-26,95,-86,-28,73,12,-73,-63,-96,9,-16,-13,-69,-23,91,-56,-29,76,64,-55,1,-21,61,-94,-27,8,38,-32,-51,97,-67,-78,77,49,14,-65,-35,64],[84,84,13,11,47,-97,12,-15,14,-21,-57,88,98,-21,-60,-75,-95,-98,61,-47,-7,43,11,11,-28,75,-98,-25,2,-6,56,84,22,9,18,78,89,-46,-51,-13,0,61,-63,-92,48,-89,54,-80,-16,39],[-32,-51,-49,-35,11,-65,-66,2,-28,-35,-29,-31,20,99,-4,80,-48,86,-95,22,-77,35,34,-10,39,-52,-84,49,93,-73,-40,-68,-2,35,-97,-43,-99,-97,-41,-69,60,-9,-18,-71,32,-26,-45,72,41,-10],[-88,28,-97,5,75,-68,56,-65,-36,48,18,-21,-12,-53,78,-27,90,1,-76,-42,-41,59,89,-40,54,-62,14,-91,88,-52,36,-63,73,-21,-6,-80,-79,62,-14,-79,-81,73,35,56,76,11,54,88,-53,-6],[-43,-79,-94,87,-29,8,-66,20,-32,82,-31,91,-39,-73,-10,-39,-44,14,-65,-33,85,34,-46,88,73,10,91,-51,-93,-57,-12,60,81,28,-73,-24,-17,-68,-45,91,-78,86,52,36,-87,43,76,-39,14,-71],[-64,-56,60,-34,-96,-17,-74,-4,51,5,-62,16,2,35,-89,10,74,-86,-42,-44,-20,-92,-16,26,43,-66,36,-37,-51,12,-54,-76,17,-87,24,-94,43,46,8,-52,55,10,73,23,75,-82,-84,-82,-39,17],[-84,-23,0,-46,28,60,71,81,-49,5,-74,-6,44,-48,-2,61,11,31,-76,14,-79,-36,-97,64,-17,-75,-25,11,53,-67,93,86,-47,-20,-62,-73,78,-19,76,-49,62,-34,-71,96,6,-29,16,-89,-37,15],[14,-57,-84,-64,27,-45,19,35,-2,-61,-69,28,33,-32,-82,-88,-64,25,54,-68,91,26,11,39,-71,-82,54,-62,17,95,-57,-11,68,-1,79,41,-90,66,-25,68,-60,50,-68,90,-94,-68,76,-6,-81,77],[-46,15,3,0,46,-65,78,-1,-60,16,-26,59,0,4,-82,40,-7,46,30,-29,-10,-65,2,69,-90,31,0,-64,16,52,-39,-73,65,54,-34,39,74,35,-61,-69,-69,-43,-14,42,-65,-72,-59,-65,-69,33],[53,-8,-98,-13,-54,-27,19,75,66,15,71,5,-79,-53,-36,-49,-74,-31,15,-57,-20,78,2,24,-47,-31,-93,30,-51,-55,-42,38,36,-24,4,88,92,-87,1,46,-91,-11,-63,37,-95,-58,-99,-78,70,-87],[80,-55,-19,-76,-60,-29,-23,40,8,28,-34,-28,58,-88,-51,-57,32,-43,-61,-45,87,-5,-35,-74,26,30,-85,-39,-5,66,-42,80,-4,43,-96,21,61,66,-79,-96,15,-6,-44,-74,80,-35,42,-80,-43,-7],[-1,-55,-90,-55,46,-55,1,69,-95,-8,-53,-69,-38,0,39,86,-94,-19,21,-67,34,24,-82,77,-52,45,87,62,77,-3,44,14,-66,95,-41,-84,21,-62,27,45,96,9,-63,-80,65,-23,-82,33,81,91],[88,-31,-40,-34,68,-82,96,-12,27,17,57,-22,42,46,65,-83,94,-56,-29,-45,-64,19,-88,33,35,-51,42,84,-91,-12,70,67,-86,54,97,-17,21,85,-40,-4,-81,-41,16,46,-91,-73,98,-83,-19,-95],[-66,-60,52,-13,-69,13,14,-10,24,67,-83,43,47,43,65,-59,12,24,62,83,31,-36,-42,-19,83,-39,-42,-18,57,-72,45,42,91,83,41,61,48,-36,79,-27,14,13,-94,90,-23,29,-95,-17,15,91],[26,-98,95,13,-6,-65,5,-9,-81,-56,82,99,51,87,-11,-86,90,35,74,-65,85,19,-12,78,-26,95,-10,-96,-50,-33,-43,52,-58,0,0,39,59,71,-21,73,-33,70,2,62,-63,77,88,-24,-73,46]]
#arr = [[-1, 0, -2], [3, -1, -4], [0, 1, 2]]
Solution().minFallingPathSum(arr)
